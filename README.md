# PyCharge

> PyCharge is an open-source Python library for differentiable electromagnetics simulations of moving point charges with JAX.

<div align="center">

[![build](https://github.com/MatthewFilipovich/pycharge/actions/workflows/build.yml/badge.svg)](https://github.com/MatthewFilipovich/pycharge/actions/workflows/build.yml)
[![Codecov](https://img.shields.io/codecov/c/github/matthewfilipovich/pycharge?token=52MBM273IF)](https://codecov.io/gh/MatthewFilipovich/pycharge)
[![Documentation Status](https://readthedocs.org/projects/pycharge/badge/?version=latest)](https://pycharge.readthedocs.io/en/latest/?badge=latest)
[![PyPI version](https://img.shields.io/pypi/v/pycharge.svg)](https://pypi.org/project/pycharge/)
[![Python Version](https://img.shields.io/badge/python-3.10%2B-blue)](https://www.python.org/downloads/)
[![License](https://img.shields.io/github/license/MatthewFilipovich/pycharge?color=blue)](https://github.com/MatthewFilipovich/pycharge/blob/main/LICENSE)

</div>

<p align="center">
  <img width="300" src="https://raw.githubusercontent.com/MatthewFilipovich/pycharge/master/docs/figs/oscillating_charge.gif">
</p>

# Key Features

- Calculate the relativistically-correct electromagnetic fields and potentials generated by moving point charge sources in a system at specified grid points in space and time. The moving point charges can have custom trajectories.
- Self-consistent simulatations of dipoles modeled as Lorentz oscillators which are driven by the electric field in the system. PyCharge dynamically determines the dipole moment at each time step.
- Expected coupling between dipoles predicted by QED theory is captured in the simulations, and the modified radiative properties of the dipoles (radiative decay rate and frequency shift) can be extracted using the dipole's energy at each time step.
- Moving dipoles can be modelled by specifying the dipole's origin position as a function of time.
- Parallelized version of the dipole simulation method using [mpi4py](https://mpi4py.readthedocs.io/en/stable/) to enable the parallel execution of computationally demanding simulations on high performance computing environments to significantly improve run time.

PyCharge was developed to allow both novice and experienced users model a wide range of classical electrodynamics systems using point charges: the package can be used as a pedagogical tool for undergraduate and graduate-level EM theory courses to provide an intuitive understanding of the EM waves generated by moving point charges, and can also be used by researchers in the field of nano-optics to investigate the complex interactions of light in nanoscale environments.

Our research paper, published in [Computational Physics Communications](https://doi.org/10.1016/j.cpc.2022.108291) and available on [arXiv](https://arxiv.org/abs/2107.12437), introduces the PyCharge package and provides a comprehensive review of the rich physics that govern the coupled dipole simulations.

## Documentation

Access the latest documentation at [pycharge.readthedocs.io](https://pycharge.readthedocs.io/).

## Installation

To install the latest **stable release** of PyCharge from [PyPI](https://pypi.org/project/pycharge/), run:

```sh
pip install pycharge
```

For the latest **development version**, install directly from [GitHub](https://github.com/MatthewFilipovich/pycharge):

```sh
git clone https://github.com/MatthewFilipovich/pycharge
cd pycharge
pip install -e '.[dev]'
```

This installs the library in editable mode, along with additional dependencies for development and testing.

## Usage

The electromagnetic fields and potentials generated by moving point charges can be calculated using PyCharge with only a few lines of code. The following script calculates the electric field components and scalar potential along a spatial grid in the x-y plane generated by two stationary charges:

```python
import pycharge as pc
from numpy import linspace, meshgrid
from scipy.constants import e
sources = (pc.StationaryCharge((10e-9, 0, 0), e),
           pc.StationaryCharge((-10e-9, 0, 0), -e))
simulation = pc.Simulation(sources)
coord = linspace(-50e-9, 50e-9, 1001)
x, y, z = meshgrid(coord, coord, 0, indexing='ij')
Ex, Ey, Ez = simulation.calculate_E(0, x, y, z)
V = simulation.calculate_V(0, x, y, z)
```

_For more examples and detailed usage, please refer to the [documentation](https://pycharge.readthedocs.io/)._

## Contributing

We welcome bug reports, questions, and feature suggestions to improve PyCharge.

- **Found a bug or have a question?** Please [open an issue on GitHub](https://github.com/MatthewFilipovich/pycharge/issues).
- **Want to contribute a new feature?** Follow these steps:

1. **Fork the repository**: Go to <https://github.com/MatthewFilipovich/pycharge/fork>
2. **Create a feature branch**: `git checkout -b feature/fooBar`
3. **Commit your changes**: `git commit -am 'Add some fooBar'`
4. **Push to the branch**: `git push origin feature/fooBar`
5. **Submit a Pull Request**: Open a Pull Request on GitHub

## Citing PyCharge

If you use PyCharge in your research, please cite our paper:

> M. Filipovich and S. Hughes, _PyCharge: An open-source Python package for self-consistent electrodynamics simulations of Lorentz oscillators and moving point charges_, [Comput. Phys. Commun.](https://doi.org/10.1016/j.cpc.2022.108291) 274, 108291 (2022).

## License

PyCharge is distributed under the MIT License. See the [LICENSE](https://github.com/MatthewFilipovich/pycharge/blob/main/LICENSE) file for more details.
