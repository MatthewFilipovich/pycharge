Lorentz Oscillators
===================

The optical interactions between light and matter at the nanometer scale are important phenomena for a variety of research fields, and a rigorous understanding of these interactions requires the use of quantum electrodynamics (QED) theory.  
However, nanometer-scale structures are often too complex to be solved rigorously using only QED; in these cases, a classical approach that invokes QED results in a phenomenological way can be applied.  

PyCharge uses the Lorentz oscillator (LO) model, an approximation derived from quantum theory (e.g., from the time-dependent Schrödinger), to simulate the interaction of a bound charge (such as an electron) with light.

In the classical model, an oscillating dipole produces electromagnetic radiation that dissipates energy and modifies the self-consistent dipole moment.  
The recoil force, :math:`\mathbf{F}_\mathrm{r}`, acting on the accelerating point charges in the dipole is called the *radiation reaction* or *radiation damping* force.  
The equation of motion for an undriven LO (e.g., in vacuum) that includes the radiation reaction force is given by

.. math::
   :label: eq:undriven_EOM

   m \mathbf{\ddot r_{\rm dip}}(t) + \omega_0^2 m \mathbf{r_\mathrm{dip}}(t) = \mathbf{F}_\mathrm{r}(t),

where :math:`\mathbf{r}_{\rm dip}` is the displacement from the LO’s negative charge to its positive charge,  
:math:`\mathbf{\ddot r_{\rm dip}}` is its second derivative with respect to time, :math:`\omega_0` is its natural angular frequency, and :math:`m` is the effective mass (also called reduced masss) of the LO, defined as

.. math::
   :label: eq:eff_mass

   m=\frac{m_1 m_2}{m_1+m_2},

where :math:`m_1` and :math:`m_2` are the masses of the two point charges in the dipole.  


The radiation reaction force :math:`\mathbf{F}_\mathrm{r}` acting on the accelerating point charges is described by the Abraham–Lorentz formula for non-relativistic velocities:

.. math::
   :label: eq:Fr

   \mathbf{F}_\mathrm{r}(t)=\frac{q^2}{6\pi\epsilon_0 c^3}\,\mathbf{\dddot r_\mathrm{dip}}(t),

where :math:`\mathbf{\dddot r_\mathrm{dip}}` is the third derivative of the displacement between the two charges.  
We can approximate :math:`\mathbf{\dddot r}_\mathrm{dip}\approx -\omega_0^2\mathbf{\dot r}_\mathrm{dip}` in the above equation if the damping introduced by radiation reaction is negligible  
(i.e., :math:`|\mathbf{F}_\mathrm{r}| \ll \omega_0^2 m |\mathbf{r}_\mathrm{dip}|`), satisfying

.. math::
   :label: eq:dipole_condition

   \frac{q^2 \omega_0}{m} \ll 6\pi \epsilon_0 c^3.

In an inhomogeneous environment, an oscillating electric dipole experiences an external electric field :math:`\mathbf{E}_\mathrm{d}` as a driving force —  
the component of the total electric field along the polarization direction at the dipole’s origin (center of mass) :math:`\mathbf{R}`,  
generated by other sources in the system and its own scattered field.  

If the above condition is satisfied, the equation of motion for a *driven* LO is

.. math::
   :label: eq:LO_equation

   \mathbf{\ddot d}(t) +\gamma_{0} \mathbf{\dot d}(t) +\omega_{0}^{2} {\bf d}(t)
   = \frac{q^2}{m} \mathbf{E}_\mathrm{d}(\mathbf{R}, t),

where :math:`{\bf d}=q{\bf r_{\rm dip}}` is the dipole moment,  
:math:`\mathbf{\dot d}` and :math:`\mathbf{\ddot d}` are its first and second derivatives,  
:math:`\gamma_0` is the *free-space energy decay rate* given by

.. math::
   :label: eq:gamma0

   \gamma_0 = \frac{q^2\omega_0^2}{6\pi\epsilon_0c^3m}.

This equation of motion corresponds to a Lorentzian atom model with transition frequency :math:`\omega_0` and linewidth :math:`\gamma_0` (where :math:`\gamma_0 \ll \omega_0`),  
valid for non-relativistic velocities since relativistic mass effects are neglected.

PyCharge Implementation
-----------------------

The driven Lorentz Oscillator equation of motion (Eq. :eq:`eq:LO_equation`) is the core of dynamic dipole simulations in PyCharge. This ODE is solved numerically by the :func:`~pycharge.simulate` function.

You can create a Lorentz Oscillator source using the :func:`~pycharge.dipole_source` factory function. This function automatically constructs the necessary ODE function that :func:`~pycharge.simulate` will use to time-step the dipole's state.

.. code-block:: python

   from scipy.constants import e, m_e
   from pycharge import dipole_source

   # Create a dipole source with a natural frequency of 200*pi THz
   lorentz_oscillator = dipole_source(
       d_0=[0.0, 0.0, 1e-11],  # Initial displacement
       q=e,
       omega_0=100e12 * 2 * 3.14159,
       m=m_e,
   )

   # This 'lorentz_oscillator' object can now be passed to 'simulate'.
   # The simulator will calculate the driving field E_d at each step
   # and solve the ODE to find the new dipole moment.


----

Quantum Correspondence
----------------------

It is useful to discuss how the decay dynamics of LOs relate to those of a quantum two-level system (TLS) in certain limits.  
In the *weak-excitation (linear response)* regime, we can connect the quantum mechanical equations of motion for a TLS to the classical LO equations by replacing :math:`q^2/m` with :math:`q^2 f/m`,  
where :math:`f` is the **oscillator strength**, defined as

.. math::
   :label: eq:f

   f = \frac{2m \omega_0 d_0^2}{\hbar q^2},

where :math:`d_0 = |\mathbf{d}(t=0)|`.  
We then recover the standard expression for the **spontaneous emission (SE) rate** :math:`\gamma_{0,\mathrm{TLS}}` from an excited TLS:

.. math::
   :label: eq:SE0

   \gamma_{0,\mathrm{TLS}} = \frac{\omega_0^3 d_0^2}{3\pi\epsilon_0 \hbar c^3}

An alternative argument relating dipole moment to radiative decay rate is to equate the total mean energy of the LO with the ground-state energy of a quantized harmonic oscillator:

.. math::

   \frac{m\omega_0^2 d_0^2}{q^2} = \frac{\hbar\omega_0}{2},

yielding :math:`q^2/m = 2\omega_0 d_0^2/\hbar`, as expected.  
Using Fermi’s golden rule and the interaction Hamiltonian :math:`H_\mathrm{int} = -{\bf d} \cdot \hat{\bf E}`,  
we obtain rate equations for the populations of an isolated TLS in vacuum:

.. math::
   :label: eq:ne

   \dot n_\mathrm{e}(t) = -\gamma_0 n_\mathrm{e}(t),

.. math::
   :label: eq:ng

   \dot n_\mathrm{g}(t) = \gamma_0 n_\mathrm{e}(t),

where :math:`n_g` and :math:`n_e` are the populations of the ground and excited states, respectively (:math:`n_g+n_e=1`).  
Here, :math:`\gamma_0` is identical to the Einstein *A coefficient*,  
so the energy decay rate equals the population decay rate.  
The analogy between LO dynamics and TLS populations holds only in the weak-excitation limit.

----

Energy of a Dipole
------------------

The total energy :math:`\mathcal{E}` of a dipole, which is the sum of its kinetic and potential energies, is calculated in **PyCharge** as

.. math::
   :label: eq:dipoleE

   \mathcal{E}(t) = \frac{m \omega_0^2}{2q^2} d^2(t) + \frac{m}{2q^2} \dot d^2(t),

where :math:`\dot d = |\mathbf{\dot d}|`.

.. note::
   In a simulation, the dipole moment :math:`\mathbf{d}(t)` and its derivative :math:`\mathbf{\dot d}(t)` are calculated from the state array returned by the :func:`~pycharge.simulate` function. The state array contains the position and velocity of each charge in the dipole at each time step.

Since the total dipole energy :math:`\mathcal{E}` is proportional to the excited-state population, the normalized population can be determined from

.. math::
   :label: eq:ne_energy

   n_e(t)=\frac{\mathcal{E}(t)}{\max (\mathcal{E})}.

----

.. rubric:: References

- L. Novotny and B. Hecht, *Principles of Nano-Optics*, Ch. 8  

- P. Milonni and J. Eberly, *Lasers Physics*, Ch. 3  

- D.J. Griffiths, *Introduction to Electrodynamics*, Ch. 11